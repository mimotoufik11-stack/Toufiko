---
import BaseLayout from './BaseLayout.astro';
import { Fragment } from 'astro/jsx-runtime';

export interface Props {
  title: string;
  description?: string;
  intro?: string;
  cta?: {
    text: string;
    href: string;
  } | null;
}

const {
  title,
  description = '',
  intro,
  cta = null
} = Astro.props;

if (!title) {
  throw new Error('CollectionLayout requires a `title` prop.');
}

const hasHero = Astro.slots.has('hero');
const hasFilters = Astro.slots.has('filters');
---
<BaseLayout {title} {description}>
  {hasHero && (
    <Fragment slot="hero">
      <slot name="hero" />
    </Fragment>
  )}
  <section class="space-y-10">
    <header class="space-y-4">
      <div class="flex flex-col gap-3">
        <p class="text-xs uppercase tracking-[0.3em] text-primary/70">Curated collection</p>
        <h1 class="text-3xl font-semibold text-[var(--color-text)] sm:text-4xl">{title}</h1>
      </div>
      {intro && (
        <p class="max-w-3xl text-base text-[var(--color-text)]/70">
          {intro}
        </p>
      )}
    </header>

    {hasFilters && (
      <div class="rounded-2xl border border-primary/10 bg-[var(--color-muted)]/60 p-4 dark:bg-slate-900/60">
        <slot name="filters" />
      </div>
    )}

    <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
      <slot />
    </div>

    {cta && (
      <div class="flex justify-center">
        <a
          href={cta.href}
          class="inline-flex items-center gap-2 rounded-full bg-primary px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-primary/40 transition hover:bg-primary/90"
        >
          {cta.text}
        </a>
      </div>
    )}
  </section>
</BaseLayout>
